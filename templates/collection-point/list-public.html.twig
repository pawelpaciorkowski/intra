{% extends 'base-public.html.twig' %}

{% block body %}

    <div class="container">

        {% if app.user %}
            {% set optionAdditionalContent %}
                <div class="btn-vertical-align">
                    <div class="btn-group btn-group-styled btn-group-large">
                        <a href="{{ path(app.request.get('_route'), app.request.query.all|merge({'page': app.request.get('page')|default(1), 'setting_collection_point_only_active': 1})) }}" class="btn {% if (setting.getSetting('collection_point_only_active', app.user)) %} active{% endif %}" title="{{ "Pokaż tylko aktywne punkty pobrań"|trans }}" data-toggle="tooltip">{{ "Tylko aktywne"|trans }}</a>
                        <a href="{{ path(app.request.get('_route'), app.request.query.all|merge({'page': app.request.get('page')|default(1), 'setting_collection_point_only_active': 0})) }}" class="btn {% if not (setting.getSetting('collection_point_only_active', app.user)) %} active{% endif %}" title="{{ "Pokaż wszystkie punkty pobrań"|trans }}" data-toggle="tooltip">{{ "Wszystkie"|trans }}</a>
                    </div>
                </div>
            {% endset %}
        {% endif %}

        {% include 'partials/list-header-public.html.twig' with {'action': 'collection-point-create'} %}

        {{ special|raw }}

        {% if rows.count %}
            {% set class = 'collection-point' %}
            {% set columns = {
                'user':                            {'name': 'Koordynator',                                               'showByDefault': true,  'sort': true,  'filter': true},
                'user-region':                     {'name': 'Dyrektor regionalny',                                       'showByDefault': true,  'sort': true,  'filter': true},
                'name':                            {'name': 'Nazwa',                                                     'showByDefault': true,  'sort': true,  'filter': true},
                'is-active':                       {'name': 'Czy aktywny',                                               'showByDefault': true,  'sort': true,  'filter': false, 'type': 'boolean'},
                'is-web':                          {'name': 'Widoczny na www',                                           'showByDefault': false, 'sort': true,  'filter': true, 'type': 'boolean'},
                'is-shop':                         {'name': 'Sprzedaż przez internet',                                   'showByDefault': false, 'sort': true,  'filter': true, 'type': 'boolean'},
                'is-contest':                      {'name': 'Konkurs',                                                   'showByDefault': false, 'sort': true,  'filter': true, 'type': 'boolean'},
                'is-covid-private':                {'name': 'Covid prywatny',                                            'showByDefault': true,  'sort': true,  'filter': true, 'type': 'boolean'},
                'is-40-plus':                      {'name': 'Program 40+',                                               'showByDefault': true,  'sort': true,  'filter': true, 'type': 'boolean'},
                'marcel':                          {'name': 'Marcel',                                                    'showByDefault': true,  'sort': true,  'filter': true},
                'mpk':                             {'name': 'MPK',                                                       'showByDefault': true,  'sort': true,  'filter': true},
                'street':                          {'name': 'Adres',                                                     'showByDefault': true,  'sort': true,  'filter': true},
                'address-info':                    {'name': 'Dodatkowe informacje o adresie',                            'showByDefault': false, 'sort': true,  'filter': true},
                'is-card':                         {'name': 'Płatność kartą',                                            'showByDefault': false, 'sort': true,  'filter': true, 'type': 'boolean'},
                'is-for-disabled':                 {'name': 'Dostęp dla osób niepełnosprawnych ',                        'showByDefault': false, 'sort': true,  'filter': true, 'type': 'boolean'},
                'city':                            {'name': 'Miasto',                                                    'showByDefault': true,  'sort': true,  'filter': true},
                'province':                        {'name': 'Województwo',                                               'showByDefault': true,  'sort': true,  'filter': true},
                'postal-code':                     {'name': 'Kod pocztowy',                                              'showByDefault': true,  'sort': true,  'filter': true},
                'phones':                          {'name': 'Telefony',                                                  'showByDefault': true,  'sort': false, 'filter': true},
                'is-internet':                     {'name': 'Dostęp do internetu',                                       'showByDefault': false, 'sort': true,  'filter': true, 'type': 'boolean'},
                'is-children':                     {'name': 'Przyjazny dzieciom',                                        'showByDefault': true,  'sort': true,  'filter': true, 'type': 'boolean'},
                'is-children-confirm':             {'name': 'Przyjazny dzieciom - wymagane potwierdzenie telefonicznie', 'showByDefault': false, 'sort': true,  'filter': true, 'type': 'boolean'},
                'is-children-age':                 {'name': 'Przyjazny dzieciom - od wieku',                             'showByDefault': false, 'sort': true,  'filter': true},
                'is-dermatofit':                   {'name': 'Dermatofity',                                               'showByDefault': false, 'sort': true,  'filter': true, 'type': 'boolean'},
                'is-dermatofit-confirm':           {'name': 'Dermatofity - wymagane potwierdzenie telefonicznie',        'showByDefault': false, 'sort': true,  'filter': true, 'type': 'boolean'},
                'is-gynecology':                   {'name': 'Ginekologiczny',                                            'showByDefault': true,  'sort': true,  'filter': true, 'type': 'boolean'},
                'is-gynecology-confirm':           {'name': 'Ginekologiczny - wymagane potwierdzenie telefonicznie',     'showByDefault': false, 'sort': true,  'filter': true, 'type': 'boolean'},
                'additional-info':                 {'name': 'Uwagi',                                                     'showByDefault': true,  'sort': true,  'filter': true},
                'internal-info':                   {'name': 'Wewnętrzne komentarze',                                     'showByDefault': false, 'sort': true,  'filter': true},
                'latitude':                        {'name': 'Długość geograficzna',                                      'showByDefault': false, 'sort': true,  'filter': true},
                'longitude':                       {'name': 'Szerokość geograficzna',                                    'showByDefault': false, 'sort': true,  'filter': true},
                'walk-3d':                         {'name': 'Spacer 3D',                                                 'showByDefault': false, 'sort': true,  'filter': true},
                'email':                           {'name': 'E-mail',                                                    'showByDefault': true,  'sort': true,  'filter': true},
                'laboratory':                      {'name': 'Laboratorium',                                              'showByDefault': true,  'sort': true,  'filter': true},
                'collection-point-classification': {'name': 'Klasyfikacja',                                              'showByDefault': false, 'sort': true,  'filter': true},
                'collection-point-location':       {'name': 'Rodzaj punktu',                                             'showByDefault': false, 'sort': true,  'filter': true},
                'collection-point-partner':        {'name': 'Spółka prowadząca',                                         'showByDefault': true,  'sort': true,  'filter': true},
                'taking-samples':                  {'name': 'Liczba osób pobierających',                                 'showByDefault': false, 'sort': true,  'filter': true},
                'registrants':                     {'name': 'Liczba osób rejestrujących',                                'showByDefault': false, 'sort': true,  'filter': true},
                'price-list':                      {'name': 'Cennik',                                                    'showByDefault': false, 'sort': true,  'filter': true},
                'collection-point-alternative':    {'name': 'Punkt alternatywny',                                        'showByDefault': false, 'sort': true,  'filter': true},
                'open-at':                         {'name': 'Data uruchomienia',                                         'showByDefault': false, 'sort': true,  'filter': true},
                'signed-at':                       {'name': 'Data podpisania umowy',                                     'showByDefault': false, 'sort': true,  'filter': true},
                'close-at':                        {'name': 'Data zamknięcia',                                           'showByDefault': false, 'sort': true,  'filter': true},
                'chatbotize-calendars':            {'name': 'Kalendarz wizyt',                                           'showByDefault': false, 'sort': true,  'filter': true},
            } %}

            {% set isFilterBarVisible = false %}
            {% for key,text in columns %}
                {% if app.request.get(key) != '' %}
                    {% set isFilterBarVisible = true %}
                {% endif %}
            {% endfor %}

            <form method="get" action="">
                <div class="row">
                    <div class="col-md-12">
                        <div class="vertical-scroll">
                            <table class="table table-striped table-hover table-stick" data-table="collection-point">
                                <thead>
                                <tr>
                                    <th class="mr-thin-column">
                                        <div class="btn-group dropdown">
                                            {% if app.user %}
                                                <button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown">
                                                    <span class="fas fa-fw fa-columns"></span>
                                                </button>
                                            {% endif %}
                                            <button type="button" class="btn btn-default btn-xs mr-filter-button {% if isFilterBarVisible %}active{% endif %}" data-toggle="button">
                                                <span class="fas fa-fw fa-filter"></span>
                                            </button>
                                            {% if app.user %}
                                                <ul class="dropdown-menu pull-left dropdown-column-select" role="menu">
                                                    <li>
                                                        {% for key,params in columns %}
                                                            <div class="switch switch-xs">
                                                                <input type="checkbox" id="checkbox-{{ loop.index }}" {{ user_table_column_visible('checkbox', true, class, key)|raw }}>
                                                                <label for="checkbox-{{ loop.index }}">
                                                                    {{ params.name }}
                                                                </label>
                                                            </div>
                                                        {% endfor %}
                                                    </li>
                                                </ul>
                                            {% endif %}
                                        </div>
                                    </th>
                                    {% for key,params in columns %}
                                        {% if app.user or params.showByDefault %}
                                            {% if app.user and params.sort %}
                                                <th {{ user_table_column_visible('column', true, class, key)|raw }}>{{ user_table_column_order(params.name, class, key) }}</th>
                                            {% else %}
                                                <th {{ user_table_column_visible('column', true, class, key)|raw }}>{{ params.name }}</th>
                                            {% endif %}
                                        {% endif %}
                                    {% endfor %}
                                    <th>
                                        {% if security.hasAccess('collection-point-csv') or security.hasAccess('collection-point-xlsx') %}
                                            <div class="dropdown pull-right">
                                                <button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" title="Pobierz przefiltrowane dane" id="dropdownMenuButton">
                                                    <span class="fas fa-fw fa-download"></span>
                                                </button>
                                                <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton">
                                                    {% if security.hasAccess('collection-point-csv') %}
                                                        <li><a href="{{ path('collection-point-csv', app.request.query.all) }}" title="Pobierz przefiltrowane dane w pliku CSV" data-toggle="tooltip" data-placement="left">Pobierz CSV</a></li>
                                                    {% endif %}
                                                    {% if security.hasAccess('collection-point-xlsx') %}
                                                        <li><a href="{{ path('collection-point-xlsx', app.request.query.all) }}" title="Pobierz przefiltrowane dane w pliku XLSX" data-toggle="tooltip" data-placement="left">Pobierz XLSX</a></li>
                                                    {% endif %}
                                                    {% if security.hasAccess('user-file-export') %}
                                                        <li role="separator" class="divider"></li>
                                                        <li><a href="{{ path('user-file-export') }}" title="Wybierz aby przejść do ustawień danych eksportowanych do pliku" data-toggle="tooltip" data-placement="bottom">Ustawienia</a></li>
                                                    {% endif %}
                                                </ul>
                                            </div>
                                        {% endif %}
                                    </th>
                                </tr>
                                <tr class="mr-filter-row {% if not isFilterBarVisible %}mr-hidden{% endif %}">
                                    <td></td>
                                    {% for key,params in columns %}
                                        {% if app.user or params.showByDefault %}
                                            {% if params.filter %}
                                                <td {{ user_table_column_visible('column', true, class, key)|raw }}>
                                                    <div class="form-group">
                                                    {% if params.type|default == 'boolean' %}
                                                        <select name="{{ key }}" id="{{ key }}">
                                                            <option value=""></option>
                                                            <option value="0" {% if app.request.get(key) == '0' %}selected="selected"{% endif %}>nie</option>
                                                            <option value="1" {% if app.request.get(key) == '1' %}selected="selected"{% endif %}>tak</option>
                                                        </select>
                                                    {% else %}
                                                        <input type="text" class="form-control" name="{{ key }}" placeholder="" value="{{ app.request.get(key) }}">
                                                    {% endif %}
                                                    </div>
                                                </td>
                                            {% else %}
                                                <td {{ user_table_column_visible('column', true, class, key)|raw }}></td>
                                            {% endif %}
                                        {% endif %}
                                    {% endfor %}
                                    <td>
                                        <div class="btn-toolbar">
                                            <button class="btn btn-default btn-xs" data-toggle="tooltip"
                                                    title="przefiltruj wg kryteriów">
                                                <span class="fas fa-fw fa-filter"></span></button>
                                            <button class="btn btn-default btn-xs mr-filter-reset" data-toggle="tooltip"
                                                    title="wyczyść wszystkie filtry">
                                                <span class="fas fa-fw fa-trash-alt"></span></button>
                                        </div>
                                    </td>
                                </tr>
                                </thead>
                                <tbody>
                                {% for row in rows %}
                                    <tr>
                                        <td class="mr-thin-column">{{ loop.index + (rows_per_page * (app.request.get('page') - 1)) }}</td>
                                        {% if app.user or columns['user']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'user')|raw }}>
                                                {% if row.user %}
                                                    {% if security.hasAccess('user-update') %}
                                                        <a href="{{ path('user-update', {'id': row.user.id}) }}" class="text-alternative{% if not row.isActive %} inactive{% endif %}">{{ row.user.fullname }}</a>
                                                    {% elseif (security.hasAccess('collection-point-view')) %}
                                                        <a href="{{ path('collection-point-view', {'id': row.id}) }}"{% if not row.isActive %} class="inactive"{% endif %}>{{ row.user.fullname }}</a>
                                                    {% else %}
                                                        {{ row.user.fullname }}
                                                    {% endif %}
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['user-region']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'user-region')|raw }}>
                                                {% if row.user2 %}
                                                    {% if security.hasAccess('user-update') %}
                                                        <a href="{{ path('user-update', {'id': row.user2.id}) }}" class="text-alternative{% if not row.isActive %} inactive{% endif %}">{{ row.user2.fullname }}</a>
                                                    {% elseif (security.hasAccess('collection-point-view')) %}
                                                        <a href="{{ path('collection-point-view', {'id': row.id}) }}"{% if not row.isActive %} class="inactive"{% endif %}>{{ row.user2.fullname }}</a>
                                                    {% else %}
                                                        {{ row.user2.fullname }}
                                                    {% endif %}
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['name']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'name')|raw }}>
                                                {% if security.hasAccess('collection-point-view') %}
                                                    <a href="{{ path('collection-point-view', {'id': row.id}) }}"{% if not row.isActive %} class="inactive"{% endif %}>{{ row.name }}</a>
                                                {% else %}
                                                    {{ row.name }}
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['is-active']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'is-active')|raw }}>
                                                {% if security.hasAccess('collection-point-view') %}
                                                    <a href="{{ path('collection-point-view', {'id': row.id}) }}"{% if not row.isActive %} class="inactive"{% endif %}><span class="fas fa-{% if row.isActive %}check{% else %}minus{% endif %}"></span></a>
                                                {% else %}
                                                    <span class="fas fa-{% if row.isActive %}check{% else %}minus{% endif %}"></span>
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['is-web']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'is-web')|raw }}>
                                                {% if (security.hasAccess('collection-point-view')) %}
                                                    <a href="{{ path('collection-point-view', {'id': row.id}) }}"{% if not row.isActive %} class="inactive"{% endif %}><span class="fas fa-{% if row.isWeb %}check{% else %}minus{% endif %}"></span></a>
                                                {% else %}
                                                    <span class="fas fa-{% if row.isWeb %}check{% else %}minus{% endif %}"></span>
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['is-shop']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'is-shop')|raw }}>
                                                {% if (security.hasAccess('collection-point-view')) %}
                                                    <a href="{{ path('collection-point-view', {'id': row.id}) }}"{% if not row.isActive %} class="inactive"{% endif %}><span class="fas fa-{% if row.isShop %}check{% else %}minus{% endif %}"></span></a>
                                                {% else %}
                                                    <span class="fas fa-{% if row.isShop %}check{% else %}minus{% endif %}"></span>
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['is-contest']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'is-contest')|raw }}>
                                                {% if (security.hasAccess('collection-point-view')) %}
                                                    <a href="{{ path('collection-point-view', {'id': row.id}) }}"{% if not row.isActive %} class="inactive"{% endif %}><span class="fas fa-{% if row.isContest %}check{% else %}minus{% endif %}"></span></a>
                                                {% else %}
                                                    <span class="fas fa-{% if row.isContest %}check{% else %}minus{% endif %}"></span>
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['is-covid-private']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'is-covid-private')|raw }}>
                                                {% if (security.hasAccess('collection-point-view')) %}
                                                    <a href="{{ path('collection-point-view', {'id': row.id}) }}"{% if not row.isActive %} class="inactive"{% endif %}><span class="fas fa-{% if row.isCovidPrivate %}check{% else %}minus{% endif %}"></span></a>
                                                {% else %}
                                                    <span class="fas fa-{% if row.isCovidPrivate %}check{% else %}minus{% endif %}"></span>
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['is-40-plus']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'is-40-plus')|raw }}>
                                                {% if (security.hasAccess('collection-point-view')) %}
                                                    <a href="{{ path('collection-point-view', {'id': row.id}) }}"{% if not row.isActive %} class="inactive"{% endif %}><span class="fas fa-{% if row.is40Plus %}check{% else %}minus{% endif %}"></span></a>
                                                {% else %}
                                                    <span class="fas fa-{% if row.is40Plus %}check{% else %}minus{% endif %}"></span>
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['marcel']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'marcel')|raw }}>
                                                {% if security.hasAccess('collection-point-view') %}
                                                    <a href="{{ path('collection-point-view', {'id': row.id}) }}"{% if not row.isActive %} class="inactive"{% endif %}>{{ row.marcel }}</a>
                                                {% else %}
                                                    {{ row.marcel }}
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['mpk']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'mpk')|raw }}>
                                                {% if security.hasAccess('collection-point-view') %}
                                                    <a href="{{ path('collection-point-view', {'id': row.id}) }}"{% if not row.isActive %} class="inactive"{% endif %}>{{ row.mpk }}</a>
                                                {% else %}
                                                    {{ row.mpk }}
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['street']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'street')|raw }}>
                                                {% if security.hasAccess('collection-point-view') %}
                                                    <a href="{{ path('collection-point-view', {'id': row.id}) }}"{% if not row.isActive %} class="inactive"{% endif %}>{{ row.streetType.short|default }} {{ row.street }}</a>
                                                {% else %}
                                                    {{ row.streetType.short|default }} {{ row.street }}
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['address-info']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'address-info')|raw }}>
                                                {% if (security.hasAccess('collection-point-view')) %}
                                                    <a href="{{ path('collection-point-view', {'id': row.id}) }}"{% if not row.isActive %} class="inactive"{% endif %}>{{ row.addressInfo }}</a>
                                                {% else %}
                                                    {{ row.addressInfo }}
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['is-card']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'is-card')|raw }}>
                                                {% if (security.hasAccess('collection-point-view')) %}
                                                    <a href="{{ path('collection-point-view', {'id': row.id}) }}"{% if not row.isActive %} class="inactive"{% endif %}><span class="fas fa-{% if row.isCard %}check{% else %}minus{% endif %}"></span></a>
                                                {% else %}
                                                    <span class="fas fa-{% if row.isCard %}check{% else %}minus{% endif %}"></span>
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['is-for-disabled']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'is-for-disabled')|raw }}>
                                                {% if (security.hasAccess('collection-point-view')) %}
                                                    <a href="{{ path('collection-point-view', {'id': row.id}) }}"{% if not row.isActive %} class="inactive"{% endif %}><span class="fas fa-{% if row.isForDisabled %}check{% else %}minus{% endif %}"></span></a>
                                                {% else %}
                                                    <span class="fas fa-{% if row.isForDisabled %}check{% else %}minus{% endif %}"></span>
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['city']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'city')|raw }}>
                                                {% if row.city %}
                                                    {% if security.hasAccess('city-update') %}
                                                        <a href="{{ path('city-update', {'id': row.city.id}) }}" class="text-alternative{% if not row.isActive %} inactive{% endif %}">{{ row.city.name }}</a>
                                                    {% elseif security.hasAccess('collection-point-view') %}
                                                        <a href="{{ path('collection-point-view', {'id': row.id}) }}"{% if not row.isActive %} class="inactive"{% endif %}>{{ row.city.name }}</a>
                                                    {% else %}
                                                        {{ row.city.name }}
                                                    {% endif %}
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['province']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'province')|raw }}>
                                                {% if row.city %}
                                                    {% if security.hasAccess('province-update') %}
                                                        <a href="{{ path('province-update', {'id': row.city.province.id}) }}" class="text-alternative{% if not row.isActive %} inactive{% endif %}">{{ row.city.province.name }}</a>
                                                    {% elseif (security.hasAccess('collection-point-view')) %}
                                                        <a href="{{ path('collection-point-view', {'id': row.id}) }}"{% if not row.isActive %} class="inactive"{% endif %}>{{ row.city.province.name }}</a>
                                                    {% else %}
                                                        {{ row.city.province.name }}
                                                    {% endif %}
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['postal-code']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'postal-code')|raw }}>
                                                {% if (security.hasAccess('collection-point-view')) %}
                                                    <a href="{{ path('collection-point-view', {'id': row.id}) }}"{% if not row.isActive %} class="inactive"{% endif %}>{{ row.postalCode }}</a>
                                                {% else %}
                                                    {{ row.postalCode }}
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['phones']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'phones')|raw }}>
                                                {% for phone in row.phones %}
                                                    <a href="callto:{{ phone.number }}" class="text-alternative{% if not row.isActive %} inactive{% endif %}">{{ phone.number }}</a>
                                                    {%- if not loop.last %}, {% endif %}
                                                {% endfor %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['is-internet']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'is-internet')|raw }}>
                                                {% if (security.hasAccess('collection-point-view')) %}
                                                    <a href="{{ path('collection-point-view', {'id': row.id}) }}"{% if not row.isActive %} class="inactive"{% endif %}><span class="fas fa-{% if row.isInternet %}check{% else %}minus{% endif %}"></span></a>
                                                {% else %}
                                                    <span class="fas fa-{% if row.isInternet %}check{% else %}minus{% endif %}"></span>
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['is-children']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'is-children')|raw }}>
                                                {% if (security.hasAccess('collection-point-view')) %}
                                                    <a href="{{ path('collection-point-view', {'id': row.id}) }}"{% if not row.isActive %} class="inactive"{% endif %}><span class="fas fa-{% if row.isChildren %}check{% else %}minus{% endif %}"></span></a>
                                                {% else %}
                                                    <span class="fas fa-{% if row.isChildren %}check{% else %}minus{% endif %}"></span>
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['is-children-confirm']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'is-children-confirm')|raw }}>
                                                {% if (security.hasAccess('collection-point-view')) %}
                                                    <a href="{{ path('collection-point-view', {'id': row.id}) }}"{% if not row.isActive %} class="inactive"{% endif %}><span class="fas fa-{% if row.isChildrenConfirm %}check{% else %}minus{% endif %}"></span></a>
                                                {% else %}
                                                    <span class="fas fa-{% if row.isChildrenConfirm %}check{% else %}minus{% endif %}"></span>
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['is-children-age']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'is-children-age')|raw }}>
                                                {% if (security.hasAccess('collection-point-view')) %}
                                                    <a href="{{ path('collection-point-view', {'id': row.id}) }}"{% if not row.isActive %} class="inactive"{% endif %}>
                                                {% endif %}
                                                    {% if row.isChildrenAge > 0 %}
                                                        {{ isChildrenAgeOptions[row.isChildrenAge]|default(row.isChildrenAge~' mieś.') }}
                                                    {% endif %}
                                                {% if (security.hasAccess('collection-point-view')) %}
                                                    </a>
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['is-dermatofit']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'is-dermatofit')|raw }}>
                                                {% if (security.hasAccess('collection-point-view')) %}
                                                    <a href="{{ path('collection-point-view', {'id': row.id}) }}"{% if not row.isActive %} class="inactive"{% endif %}><span class="fas fa-{% if row.isDermatofit %}check{% else %}minus{% endif %}"></span></a>
                                                {% else %}
                                                    <span class="fas fa-{% if row.isDermatofit %}check{% else %}minus{% endif %}"></span>
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['is-dermatofit-confirm']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'is-dermatofit-confirm')|raw }}>
                                                {% if (security.hasAccess('collection-point-view')) %}
                                                    <a href="{{ path('collection-point-view', {'id': row.id}) }}"{% if not row.isActive %} class="inactive"{% endif %}><span class="fas fa-{% if row.isDermatofitConfirm %}check{% else %}minus{% endif %}"></span></a>
                                                {% else %}
                                                    <span class="fas fa-{% if row.isDermatofitConfirm %}check{% else %}minus{% endif %}"></span>
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['is-gynecology']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'is-gynecology')|raw }}>
                                                {% if (security.hasAccess('collection-point-view')) %}
                                                    <a href="{{ path('collection-point-view', {'id': row.id}) }}"{% if not row.isActive %} class="inactive"{% endif %}><span class="fas fa-{% if row.isGynecology %}check{% else %}minus{% endif %}"></span></a>
                                                {% else %}
                                                    <span class="fas fa-{% if row.isGynecology %}check{% else %}minus{% endif %}"></span>
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['is-gynecology-confirm']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'is-gynecology-confirm')|raw }}>
                                                {% if (security.hasAccess('collection-point-view')) %}
                                                    <a href="{{ path('collection-point-view', {'id': row.id}) }}"{% if not row.isActive %} class="inactive"{% endif %}><span class="fas fa-{% if row.isGynecologyConfirm %}check{% else %}minus{% endif %}"></span></a>
                                                {% else %}
                                                    <span class="fas fa-{% if row.isGynecologyConfirm %}check{% else %}minus{% endif %}"></span>
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['additional-info']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'additional-info')|raw }}>
                                                {% if (security.hasAccess('collection-point-view')) %}
                                                    <a href="{{ path('collection-point-view', {'id': row.id}) }}"{% if not row.isActive %} class="inactive"{% endif %}>{{ row.additionalInfo|raw }}</a>
                                                {% else %}
                                                    {{ row.additionalInfo|raw }}
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['internal-info']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'internal-info')|raw }}>
                                                {% if (security.hasAccess('collection-point-view')) %}
                                                    <a href="{{ path('collection-point-view', {'id': row.id}) }}"{% if not row.isActive %} class="inactive"{% endif %}>{{ row.internalInfo|raw }}</a>
                                                {% else %}
                                                    {{ row.internalInfo|raw }}
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['latitude']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'latitude')|raw }}>
                                                {% if (security.hasAccess('collection-point-view')) %}
                                                    <a href="{{ path('collection-point-view', {'id': row.id}) }}"{% if not row.isActive %} class="inactive"{% endif %}>{{ row.latitude }}</a>
                                                {% else %}
                                                    {{ row.latitude }}
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['longitude']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'longitude')|raw }}>
                                                {% if (security.hasAccess('collection-point-view')) %}
                                                    <a href="{{ path('collection-point-view', {'id': row.id}) }}"{% if not row.isActive %} class="inactive"{% endif %}>{{ row.longitude }}</a>
                                                {% else %}
                                                    {{ row.longitude }}
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['walk-3d']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'walk-3d')|raw }}>
                                                {% if (security.hasAccess('collection-point-view')) %}
                                                    <a href="{{ path('collection-point-view', {'id': row.id}) }}"{% if not row.isActive %} class="inactive"{% endif %}>{{ row.walk3d }}</a>
                                                {% else %}
                                                    {{ row.walk3d }}
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['email']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'email')|raw }}>
                                                <a href="mailto:{{ row.email }}" class="text-alternative{% if not row.isActive %} inactive{% endif %}">{{ row.email }}</a>
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['laboratory']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'laboratory')|raw }}>
                                                {% if row.laboratory %}
                                                    {% if security.hasAccess('laboratory-update') %}
                                                        <a href="{{ path('laboratory-update', {'id': row.laboratory.id}) }}" class="text-alternative{% if not row.isActive %} inactive{% endif %}">{{ row.laboratory.name }}</a>
                                                    {% elseif (security.hasAccess('collection-point-view')) %}
                                                        <a href="{{ path('collection-point-view', {'id': row.id}) }}"{% if not row.isActive %} class="inactive"{% endif %}>{{ row.laboratory.name }}</a>
                                                    {% else %}
                                                        {{ row.laboratory.name }}
                                                    {% endif %}
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['collection-point-classification']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'collection-point-classification')|raw }}>
                                                {% if row.collectionPointClassification %}
                                                    {% if security.hasAccess('collection-point-classification-update') %}
                                                        <a href="{{ path('collection-point-classification-update', {'id': row.collectionPointClassification.id}) }}" class="text-alternative{% if not row.isActive %} inactive{% endif %}">{{ row.collectionPointClassification.name }}</a>
                                                    {% elseif (security.hasAccess('collection-point-view')) %}
                                                        <a href="{{ path('collection-point-view', {'id': row.id}) }}"{% if not row.isActive %} class="inactive"{% endif %}>{{ row.collectionPointClassification.name }}</a>
                                                    {% else %}
                                                        {{ row.collectionPointClassification.name }}
                                                    {% endif %}
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['collection-point-location']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'collection-point-location')|raw }}>
                                                {% if row.collectionPointLocation %}
                                                    {% if security.hasAccess('collection-point-location-update') %}
                                                        <a href="{{ path('collection-point-location-update', {'id': row.collectionPointLocation.id}) }}" class="text-alternative{% if not row.isActive %} inactive{% endif %}">{{ row.collectionPointLocation.name }}</a>
                                                    {% elseif (security.hasAccess('collection-point-view')) %}
                                                        <a href="{{ path('collection-point-view', {'id': row.id}) }}"{% if not row.isActive %} class="inactive"{% endif %}>{{ row.collectionPointLocation.name }}</a>
                                                    {% else %}
                                                        {{ row.collectionPointLocation.name }}
                                                    {% endif %}
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['collection-point-partner']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'collection-point-partner')|raw }}>
                                                {% if row.collectionPointPartner %}
                                                    {% if security.hasAccess('collection-point-partner-update') %}
                                                        <a href="{{ path('collection-point-partner-update', {'id': row.collectionPointPartner.id}) }}" class="text-alternative{% if not row.isActive %} inactive{% endif %}">{{ row.collectionPointPartner.name }}</a>
                                                    {% elseif (security.hasAccess('collection-point-view')) %}
                                                        <a href="{{ path('collection-point-view', {'id': row.id}) }}"{% if not row.isActive %} class="inactive"{% endif %}>{{ row.collectionPointPartner.name }}</a>
                                                    {% else %}
                                                        {{ row.collectionPointPartner.name }}
                                                    {% endif %}
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['taking-samples']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'taking-samples')|raw }}>
                                                {% if (security.hasAccess('collection-point-view')) %}
                                                    <a href="{{ path('collection-point-view', {'id': row.id}) }}" class="text-alternative{% if not row.isActive %} inactive{% endif %}">{{ row.takingSamples }}</a>
                                                {% else %}
                                                    {{ row.takingSamples }}
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['registrants']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'registrants')|raw }}>
                                                {% if (security.hasAccess('collection-point-view')) %}
                                                    <a href="{{ path('collection-point-view', {'id': row.id}) }}" class="text-alternative{% if not row.isActive %} inactive{% endif %}">{{ row.registrants }}</a>
                                                {% else %}
                                                    {{ row.registrants }}
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['price-list']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'price-list')|raw }}>
                                                {% if (security.hasAccess('collection-point-view')) %}
                                                    <a href="{{ path('collection-point-view', {'id': row.id}) }}" class="text-alternative{% if not row.isActive %} inactive{% endif %}">{{ row.priceList }}</a>
                                                {% else %}
                                                    {{ row.priceList }}
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['collection-point-alternative']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'collection-point-alternative')|raw }}>
                                                {% if row.collectionPointAlternative %}
                                                    {% if (security.hasAccess('collection-point-view')) %}
                                                        <a href="{{ path('collection-point-view', {'id': row.collectionPointAlternative.id}) }}" class="text-alternative{% if not row.isActive %} inactive{% endif %}">{{ row.collectionPointAlternative.name }}</a>
                                                    {% else %}
                                                        {{ row.collectionPointAlternative.name }}
                                                    {% endif %}
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['open-at']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'open-at')|raw }}>
                                                {% if (row.openAt) %}
                                                    {% if (security.hasAccess('collection-point-view')) %}
                                                        <a href="{{ path('collection-point-view', {'id': row.id}) }}" class="text-alternative{% if not row.isActive %} inactive{% endif %}">{{ row.openAt|format_date('short') }}</a>
                                                    {% else %}
                                                        {{ row.openAt|format_date('short') }}
                                                    {% endif %}
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['signed-at']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'signed-at')|raw }}>
                                                {% if (row.openAt) %}
                                                    {% if (security.hasAccess('collection-point-view')) %}
                                                        <a href="{{ path('collection-point-view', {'id': row.id}) }}" class="text-alternative{% if not row.isActive %} inactive{% endif %}">{{ row.signedAt|format_date('short') }}</a>
                                                    {% else %}
                                                        {{ row.signedAt|format_date('short') }}
                                                    {% endif %}
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['close-at']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'close-at')|raw }}>
                                                {% if (row.closeAt) %}
                                                    {% if (security.hasAccess('collection-point-view')) %}
                                                        <a href="{{ path('collection-point-view', {'id': row.id}) }}" class="text-alternative{% if not row.isActive %} inactive{% endif %}">{{ row.closeAt|format_date('short') }}</a>
                                                    {% else %}
                                                        {{ row.closeAt|format_date('short') }}
                                                    {% endif %}
                                                {% endif %}
                                            </td>
                                        {% endif %}
                                        {% if app.user or columns['chatbotize-calendars']['showByDefault'] %}
                                            <td {{ user_table_column_visible('column', true, class, 'chatbotize-calendars')|raw }}>
                                                {% for calendar in row.calendars %}
                                                    {% if (security.hasAccess('collection-point-view')) %}
                                                        <a href="{{ path('collection-point-view', {'id': row.id}) }}" class="text-alternative{% if not row.isActive %} inactive{% endif %}">{{ calendar.chatbotizeCalendar.name }}</a>
                                                    {% else %}
                                                        {{ calendar.chatbotizeCalendar.name }}
                                                    {% endif %}
                                                    {%- if not loop.last %}, {% endif %}
                                                {% endfor %}
                                            </td>
                                        {% endif %}
                                        <td class="action-buttons">
                                            {% if security.hasAccess('collection-point-view') %}
                                                <a href="{{ path('collection-point-view', {'id': row.id}) }}" class="btn btn-default btn-xs" data-toggle="tooltip" title="Zobacz kartę">Karta</a>
                                            {% endif %}
                                        </td>
                                    </tr>
                                {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </form>

            {% include 'partials/pagination-public.html.twig' %}
        </div>

    {% else %}
        <div class="alert alert-warning" role="alert">
            <span class="fas fa-exclamation-circle"></span> Nie znaleziono żadnego punktu pobrań.<br><br>
            <a href="{{ path(app.request.attributes.get('_route')) }}" class="alert-link">Pokaż wszystko</a>
        </div>
    {% endif %}
{% endblock %}
